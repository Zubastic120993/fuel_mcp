# �� Fuel MCP — **v1.0.3 Polish Phase Plan**

**Maintainer:** Chief Engineer *Volodymyr Zub*  
**Branch:** `feature/schema-unification-v1.0.3`  
**Date:** 2025-10-31  
**Goal:** Finalize API schema unification, add CLI tools, and extend parser logic before GUI/Docker integration.

---

## ⚙️ **Phase Objective**

> Standardize all API responses, extend NLP query recognition, and introduce local CLI maintenance commands for developers.

---

## 🔹 1. Unified Response Schema

| Task | Description | Status |
|------|--------------|--------|
| **Add `_meta` to error responses** | Ensure failed API calls also return `_meta` (timestamp, query, mode) | ⏳ Pending |
| **Normalize success/error JSON structure** | Follow single schema `{success, query, mode, result, _meta}` | ⏳ Pending |
| **Add pytest coverage** | Validate uniform response structure | ⏳ Pending |

---

## 🔹 2. CLI Maintenance Tools

| Command | Description | Status |
|----------|--------------|--------|
| **mcp db-purge** | Safely clears local `/data/mcp_history.db` and logs | ⏳ Pending |
| **mcp test** | Runs pytest suite and reports summary | ⏳ Pending |
| **mcp status** | Displays current version, DB size, uptime | ⏳ Pending |

---

## 🔹 3. Regex Parser Expansion

| Task | Description | Status |
|------|--------------|--------|
| **Multi-unit parsing** | Handle queries like “convert 500 L diesel at 30°C” | ⏳ Pending |
| **Density auto-inference** | Load default density from JSON | ⏳ Pending |
| **Enhanced error handling** | Graceful fallback when missing units or temperature | ⏳ Pending |

---

## 🔹 4. Data & Config Enhancements

| File | Purpose | Status |
|------|----------|--------|
| **fuel_mcp/data/fuel_density.json** | Store default densities per product | ⏳ Pending |
| **fuel_mcp/core/cli_tools.py** | Define CLI logic and safety checks | ⏳ Pending |
| **pytest JSON output → logs/test_results.json** | Add test summary export | ⏳ Pending |

---

## 🔹 5. New /info Endpoint

| Task | Description | Status |
|------|--------------|--------|
| **Add endpoint** | `/info` returns short API + system overview (version, uptime, OS, DB size) | ⏳ Pending |
| **Add test file** | `tests/test_api_info.py` to verify structure & response time | ⏳ Pending |

---

## 🔹 6. Documentation & Automation

| Task | Description | Status |
|------|--------------|--------|
| **Export OpenAPI snapshot** | Generate `docs/api_schema_v1.0.3.json` | ⏳ Pending |
| **Add Makefile target `make openapi`** | Automate schema export | ✅ Done in v1.0.2 base |
| **Update developer Makefile** | Include `make polish` for this phase | ⏳ Pending |

---

## 📅 **Version Targets**

| Version | Focus | Tag |
|----------|--------|-----|
| **v1.0.3-rc1** | Unified schema + CLI tools | �� Next milestone |
| **v1.0.3-final** | OpenAPI + test reporting + parser polish | Later |
| **v1.1.0-gui** | Flask/Gradio GUI + Docker image | Planned |

---

## 🧾 **Next Git Steps**

```bash
git checkout -b feature/schema-unification-v1.0.3
git add docs/v1.0.3_polish_plan.md
git commit -m "🧩 Added v1.0.3 Polish Plan — schema unification + CLI roadmap"
git push origin feature/schema-unification-v1.0.3
